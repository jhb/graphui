<div id="detail">${''}
    <h4>Add node</h4>
    <form tal:define="labelnodes sorted([n for n in meta.nodes_by_label['Label']], key=lambda n: n['name']);
                      label_name request.values.get('label_name','Property');
                      thelabel label_name and meta.nln('Label',label_name) or labelnodes[0]"
          hx-post="/node_add"
          hx-target="#detail"
          hx-swap="outerHTML"
          action="/node_add"
          method="POST">
        <br>
        <label for="property_name">Select Label</label>
        <br>
        <select id="label_name" name="label_name" hx-get="/node_add" hx-target="#detail">
            <option tal:repeat="labelnode labelnodes"
                title="${labelnode['description']}"
                tal:attributes="selected label_name==labelnode['name']">${labelnode['name']}</option>
        </select>
        <div>&nbsp;</div>
        <table tal:condition='thelabel'
               tal:define="propnodes sorted(thelabel.fl.outE('PROP').target, key=lambda n: n['name'])">
            <tr tal:repeat="propnode propnodes" valign="top">
                <td style="width: 12ch"><span title="${propnode['description']}">${propnode['name']}</span></td>
                <td tal:define="widgetname propnode.get('widget','')">
                    <input
                        name="properties:${propnode['name']}"
                        tal:condition="widgetname=='string' or 1"
                        placeholder="${propnode['description']}"
                        tal:attributes="required propnode.get('arity','?') in ['1','+']">
                    ${propnode.get('arity','??')}
                </td>
            </tr>
        </table>

        <div>&nbsp;</div>

        <div tal:condition="label_name=='Relation'">
            <span tal:define="labelnodes sorted(meta.nodes_by_label['Label'], key=lambda n:n['name'])">
                <label for="source_ids">Select sources</label><br>
                <select id="source_ids" name="source_ids" multiple>
                    <option
                        tal:define="source_id int(request.values.get('source_id',-1));"
                        tal:repeat="sourcenode labelnodes"
                        title="${sourcenode['description']}"
                        value="${sourcenode.id}"
                        tal:attributes="selected source_id==sourcenode.id">
                            ( ${get_value(sourcenode)} ${':'.join(sourcenode.labels)})
                    </option>
                </select>
                <div>&nbsp;</div>
                <label for="target_ids">Select targets</label><br>
                <select id="target_ids" name="target_ids" multiple>
                    <option
                         tal:define="target_id int(request.values.get('target_id',-1));"
                         tal:repeat="targetnode labelnodes"
                        title="${targetnode['description']}"
                        value="${targetnode.id}"
                         tal:attributes="selected target_id==targetnode.id">
                            ( ${get_value(targetnode)} ${':'.join(targetnode.labels)})
                    </option>
                </select><br>

            </span>
        </div>

        <div tal:condition="label_name=='Label'">
            <span tal:define="propnodes sorted(meta.nodes_by_label['Property'], key=lambda n: n['name'])">
                <label for="property_ids">Select properties</label><br>
                <select id="property_ids" name="property_ids" multiple size="10">
                    <option
                         tal:define="property_id int(request.values.get('property_id',-1));"
                         tal:repeat="propertynode propnodes"
                        title="${propertynode['description']}"
                        value="${propertynode.id}"
                         tal:attributes="selected property_id==propertynode.id">
                            ( ${get_value(propertynode)} ${':'.join(propertynode.labels)})
                    </option>
                </select><br>

            </span>
        </div>

        <ul tal:condition="label_name=='Property'">
            <li>Labels ausw√§hlen</li>
        </ul>
        <button type="submit">Create</button>


    </form>




</div>